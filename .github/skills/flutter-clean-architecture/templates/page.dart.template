// Page Template with AutoRoute
// Location: features/${feature}/presentation/pages/${feature}_page.dart
// Replace: ${Feature} with PascalCase (e.g., FileUpload)
// Replace: ${feature} with snake_case (e.g., file_upload)

import 'package:auto_route/auto_route.dart';
import 'package:flutter/material.dart';
import 'package:flutter_bloc/flutter_bloc.dart';

import 'package:piia/core/di/service_locator.dart';
import 'package:piia/shared/shadcn.dart';

import '../bloc/${feature}_cubit.dart';

@RoutePage()
class ${Feature}Page extends StatelessWidget {
  const ${Feature}Page({
    super.key,
    @PathParam('id') this.id,
  });

  final String? id;

  @override
  Widget build(BuildContext context) {
    return BlocProvider(
      create: (_) => ServiceLocator.I<${Feature}Cubit>()
        ..load(id ?? ''),
      child: const _${Feature}View(),
    );
  }
}

class _${Feature}View extends StatelessWidget {
  const _${Feature}View();

  @override
  Widget build(BuildContext context) {
    final theme = Theme.of(context);

    return Scaffold(
      appBar: AppBar(
        title: const Text('${Feature}'),
        leading: IconButton(
          icon: const Icon(Icons.arrow_back),
          onPressed: () => context.router.pop(),
        ),
      ),
      body: BlocBuilder<${Feature}Cubit, ${Feature}State>(
        builder: (context, state) {
          // Loading state
          if (state.isLoading) {
            return const Center(
              child: CircularProgressIndicator(),
            );
          }

          // Error state
          if (state.hasError) {
            return _ErrorView(
              message: state.failure?.message ?? 'An error occurred',
              onRetry: () => context.read<${Feature}Cubit>().load(''),
            );
          }

          // Empty state
          if (!state.hasData) {
            return const _EmptyView();
          }

          // Success state
          return _ContentView(data: state.data!);
        },
      ),
    );
  }
}

class _ContentView extends StatelessWidget {
  const _ContentView({required this.data});

  final ${Feature}Entity data;

  @override
  Widget build(BuildContext context) {
    final theme = Theme.of(context);

    return SingleChildScrollView(
      padding: const EdgeInsets.all(16),
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          Text(
            data.title,
            style: theme.textTheme.titleLarge,
          ),
          const Gap(16),
          // Add your content here
        ],
      ),
    );
  }
}

class _EmptyView extends StatelessWidget {
  const _EmptyView();

  @override
  Widget build(BuildContext context) {
    return Center(
      child: Column(
        mainAxisAlignment: MainAxisAlignment.center,
        children: [
          Icon(
            Icons.inbox_outlined,
            size: 64,
            color: Theme.of(context).colorScheme.muted,
          ),
          const Gap(16),
          Text(
            'No data found',
            style: Theme.of(context).textTheme.bodyLarge,
          ),
        ],
      ),
    );
  }
}

class _ErrorView extends StatelessWidget {
  const _ErrorView({
    required this.message,
    required this.onRetry,
  });

  final String message;
  final VoidCallback onRetry;

  @override
  Widget build(BuildContext context) {
    return Center(
      child: Padding(
        padding: const EdgeInsets.all(24),
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            Icon(
              Icons.error_outline,
              size: 64,
              color: Theme.of(context).colorScheme.destructive,
            ),
            const Gap(16),
            Text(
              message,
              style: Theme.of(context).textTheme.bodyLarge,
              textAlign: TextAlign.center,
            ),
            const Gap(24),
            Button.outline(
              onPressed: onRetry,
              child: const Text('Retry'),
            ),
          ],
        ),
      ),
    );
  }
}
